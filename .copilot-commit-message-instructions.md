# 提交信息规范（Vue 社区风格 + Conventional Commits）

本仓库的提交信息遵循 **Conventional Commits**，并对齐 **Vue 社区常见风格**：

- 使用固定格式：`<type>(<scope>)!: <subject>`
- `subject` 使用祈使句/动词开头（中文或英文均可），**不要**以句号结尾
- 一次提交只表达一个清晰意图，避免“顺手改点别的”

---

## 1. 基本格式

### 1.1 标题（必填）

```
<type>(<scope>)!: <subject>
```

- `<type>`：必填，小写
- `<scope>`：可选，建议填写，用于指明影响范围
- `!`：可选，表示 Breaking Change（也可通过 Footer 声明）
- `<subject>`：必填，简短明确（建议 50 字符/25 汉字内）

### 1.2 正文（可选）

用于解释“为什么改 / 怎么改 / 影响是什么”。多行文本建议换行分段。

### 1.3 页脚 Footer（可选）

- 关联问题：`Closes #123` / `Refs #123`
- Breaking Change：

```
BREAKING CHANGE: <description>
```

---

## 2. type 取值（推荐集合）

与 Conventional Commits 一致，覆盖 Vue 社区常用类型：

- `feat`：新增功能
- `fix`：修复 bug
- `docs`：文档变更（README、docs、注释说明等）
- `style`：代码风格/格式（不影响逻辑：空格、分号、lint 格式化等）
- `refactor`：重构（既不是 feat 也不是 fix）
- `perf`：性能优化
- `test`：测试相关
- `build`：构建系统或依赖（tsdown、vite、pnpm、api-extractor 等）
- `ci`：CI 配置与脚本（GitHub Actions 等）
- `chore`：杂项维护（不改 src 逻辑且不属于以上类型）
- `revert`：回滚提交（尽量使用 `git revert` 自动生成格式）

---

## 3. scope 取值（建议）

scope 用来标注影响模块；本仓库推荐优先使用目录/子系统名：

- `reactivity`：响应式相关（effect/ref/watch/scope 等）
- `runtime-core`
- `runtime-dom`
- `jsx-runtime`
- `jsx-foundation`
- `router`
- `shared`
- `playground`
- `test`
- `docs`
- `build`
- `release`

如果影响非常聚焦，也可以更细：例如 `reactivity:watch`、`runtime-dom:props`。

---

## 4. Breaking Change 规则

满足以下任一方式即可：

1. 在标题中加 `!`：

```
feat(runtime-core)!: change component setup signature
```

2. 使用 Footer：

```
refactor(reactivity): adjust effect scheduling

BREAKING CHANGE: effect.scheduler now receives job id
```

Breaking Change 适用场景：对外 API 行为变更、类型定义不兼容、默认行为改变导致用户代码需要修改。

---

## 5. 示例（推荐写法）

```
feat(reactivity): add watchEffect support
```

```
fix(runtime-dom): remove boolean attrs when value is false
```

```
refactor(runtime-core): extract mount logic into helpers
```

```
docs: clarify createApp mount/unmount behavior
```

```
test(reactivity): cover nested effect cleanup
```

带正文与关联问题：

```
fix(shared): handle error channel rethrow timing

Make rethrow async via queueMicrotask to match runtime expectations.

Closes #88
```

---

## 6. 约束与习惯（对齐 Vue 风格）

- 标题使用小写 type；`subject` 不要首字母强制大写（中文无所谓）
- 标题不要以句号 `.` 结尾
- 避免“巨大提交”：一个 PR/提交尽量只解决一类问题
- 自动格式化/纯整理尽量用 `style` 或 `chore`，避免掺杂功能改动

---

## 7. 给 Copilot 生成提交信息的提示

当你需要为改动生成提交信息时：

1. 先判断 type（feat/fix/refactor...）
2. 再选最贴切的 scope（优先模块目录）
3. subject 用动词开头，描述“做了什么”，不描述“怎么做”细节
4. 如涉及破坏性变更，加 `!` 或 `BREAKING CHANGE:`
